# Export JSON Format Documentation

## Overview

This document describes the JSON format produced by the **Export → JSON** functionality in Rogue Trader Generator Tools. This format is designed for developers who want to integrate generated game content into their own applications or tools.

## General Structure

### Top-Level Object

When exporting from **Export → JSON → Current node** or **Export → JSON → Workspace**:

```json
{
  "exportDate": "2025-11-05T09:00:00.000Z",
  "nodes": [
    // Array of node objects
  ]
}
```

**Fields:**
- `exportDate` (string): ISO 8601 timestamp of when the export was generated
- `nodes` (array): Array of root-level node objects (systems, ships, etc.)

### Common Node Properties

All nodes share these base properties:

```json
{
  "type": "system",
  "name": "Winterscale's Realm",
  "description": "<p>HTML description of the node</p>",
  "customNotes": "<h3>Important Notes</h3><p>This system has <strong>rich resources</strong> and <em>dangerous xenos</em>.</p>",
  "customNotesPlainText": "Important Notes This system has rich resources and dangerous xenos.",
  "children": []
}
```

**Fields:**
- `type` (string, required): Node type identifier (see Node Types section)
- `name` (string, required): Display name of the node
- `description` (string, required): HTML-formatted description generated by the tool
- `customNotes` (string, optional): User-added notes with HTML formatting (only present if user added custom notes)
- `customNotesPlainText` (string, optional): Plain text version of customNotes without HTML formatting (only present if user added custom notes)
- `children` (array, optional): Child nodes (only present if the node has children; always appears last)

**Note on `description`**: This field contains HTML markup with the formatted display text. While you can parse this, the Export JSON includes structured data fields so you can generate your own display without parsing HTML.

**Note on `customNotes` vs `customNotesPlainText`**: The `customNotes` field contains HTML with formatting tags (h3, b, strong, i, em, u, ul, ol, li). For applications that don't support HTML rendering, use the `customNotesPlainText` field which contains the same content as plain text with all HTML tags stripped.

## Node Types

### System Node

**Type**: `"system"`

Represents a complete star system with zones and orbital bodies.

```json
{
  "type": "system",
  "name": "Koronus Expanse System Alpha",
  "description": "<p>A system in the Koronus Expanse...</p>",
  "star": "Red Giant",
  "starColor": "Deep red",
  "warpStatus": "Turbulent",
  "systemFeatures": ["Bountiful", "Haven", "Warp Turbulence"],
  "systemCreationRules": {
    "innerCauldronWeak": false,
    "innerCauldronDominant": false,
    "primaryBiosphereWeak": false,
    "primaryBiosphereDominant": false,
    "outerReachesWeak": false,
    "outerReachesDominant": false,
    "numExtraAsteroidBelts": 0,
    "numExtraAsteroidClusters": 0,
    "numExtraMineralResourcesPerPlanet": 2,
    "chanceForExtraExoticMaterialsPerPlanet": true,
    "bountifulAsteroids": true,
    "numExtraGravityRiptides": 0,
    "numExtraPlanetsInEachSolarZone": 1,
    "havenThickerAtmospheresInPrimaryBiosphere": true,
    "havenBetterHabitability": true,
    "ruinedEmpireExtraXenosRuinsOnDifferentPlanets": 0,
    "ruinedEmpireIncreasedAbundanceXenosRuins": false,
    "ruinedEmpireExtraArcheotechCachesOnDifferentPlanets": 0,
    "ruinedEmpireIncreasedAbundanceArcheotechCaches": false,
    "dominantRuinedSpecies": "Undefined",
    "starfarersNumSystemFeaturesInhabited": 0,
    "minimumNumPlanetsAfterModifiers": 0,
    "numPlanetsModifier": 1,
    "numPlanetsInWarpStorms": 0
  },
  "featureEffects": {
    "gravityTidesGravityWellsAroundPlanets": true,
    "illOmenedFickleFatePoints": true,
    "warpStasisNoPush": true,
    "numPlanetsInWarpStorms": 2,
    "warpTurbulenceNavigationPenalty": true,
    "warpTurbulencePsychicPhenomenaBonus": true,
    "warpTurbulenceCorruptionIncrease": true,
    "warpTurbulencePsyRatingBonus": true
  },
  "children": [
    // Zone nodes, see Zone Node section
  ]
}
```

**Fields:**
- `star` (string, optional): Star type (e.g., "Red Giant", "Blue Star")
- `starColor` (string, optional): Descriptive color of the star (e.g., "Deep red", "Yellow-orange", "Blue-white")
- `warpStatus` (string, optional): Warp condition of the system (only present if not "Normal")
  - Possible values: "Turbulent", "Becalmed", "Fully becalmed"
- `systemFeatures` (array, optional): Array of system feature names that were rolled
- `systemCreationRules` (object, optional): Detailed rule modifiers that affect system generation
- `featureEffects` (object, optional): Active system-wide effects from features
  - Gravity Tides effects: `gravityTidesGravityWellsAroundPlanets`, `gravityTidesTravelTimeBetweenPlanetsHalves`
  - Ill-Omened effects: `illOmenedFickleFatePoints`, `illOmenedWillPowerPenalty`, `illOmenedDoubledInsanity`, `illOmenedFearFromPsychicExploration`
  - Warp Stasis effects: `warpStasisFocusPowerPenalties`, `warpStasisNoPush`, `warpStasisReducedPsychicPhenomena`
  - Warp Turbulence effects: `warpTurbulenceNavigationPenalty`, `warpTurbulencePsychicPhenomenaBonus`, `warpTurbulenceCorruptionIncrease`, `warpTurbulencePsyRatingBonus`, `numPlanetsInWarpStorms` (number)

### Zone Node

**Type**: `"zone"`

Represents a solar zone within a system (Inner Cauldron, Primary Biosphere, Outer Reaches).

```json
{
  "type": "zone",
  "name": "Primary Biosphere",
  "description": "<p>The habitable zone...</p>",
  "children": [
    // Planet, Asteroid Belt, Gas Giant, etc.
  ]
}
```

**Note**: Zone nodes primarily serve as organizational containers. Their children contain the actual orbital features.

### Planet Node

**Type**: `"planet"`

Represents a planet or large moon.

```json
{
  "type": "planet",
  "name": "Verdant World",
  "description": "<p>A lush, habitable planet...</p>",
  "isMoon": false,
  "body": "Large",
  "gravity": "Normal",
  "atmosphere": "Moderate",
  "atmosphericComposition": "Tainted",
  "climate": "Temperate",
  "habitability": "Verdant",
  "continents": 3,
  "islands": 5,
  "terrain": [
    "Forest",
    "Mountains",
    "Ocean"
  ],
  "landmarks": [
    "Ancient ruins",
    "Volcanic caldera"
  ],
  "landmasses": [
    {
      "type": "Continent",
      "letter": "A",
      "name": "Continent A",
      "territories": [
        {
          "baseTerrain": "Forest",
          "traits": ["Unique Compound", "Fertile"],
          "landmarks": ["Cave Network"],
          "uniqueCompoundOrganics": ["Juvenat Compounds"]
        },
        {
          "baseTerrain": "Mountains",
          "traits": ["2x Unique Compound", "High Peaks"],
          "landmarks": [],
          "uniqueCompoundOrganics": ["Curative Compounds", "Toxins"]
        }
      ]
    },
    {
      "type": "Archipelago",
      "letter": "B",
      "name": "Archipelago B",
      "territories": [
        {
          "baseTerrain": "Ocean",
          "traits": ["Deep Waters"],
          "landmarks": ["Underwater city"]
        }
      ]
    }
  ],
  "mineralResources": [
    { "type": "Industrial Metals", "abundance": 45 },
    { "type": "Ornamentals", "abundance": 30 }
  ],
  "organicCompounds": [
    { "type": "Prey Animals", "abundance": 60 }
  ],
  "archeotechCaches": [
    { "type": "Archeotech Cache", "abundance": 15 }
  ],
  "xenosRuins": [
    { "type": "Xenos Ruins", "abundance": 25 }
  ],
  "inhabitants": "Human",
  "inhabitantDevelopment": "Colony",
  "techLevel": "Imperial (4)",
  "population": "Hundreds of Millions",
  "maidenWorld": false,
  "warpStorm": false,
  "children": [
    // Orbital Features, Lesser Moons, Native Species, Notable Species, etc.
  ]
}
```

**Fields:**
- `isMoon` (boolean, optional): True if this is a moon rather than a planet
- `body` (string, optional): Size category
- `gravity` (string, optional): Gravity description
- `atmosphere` (string, optional): Atmospheric presence
- `atmosphericComposition` (string, optional): Atmospheric composition type
- `climate` (string, optional): Climate description
- `habitability` (string, optional): Habitability level (only if not "Inhospitable")
- `continents` (number, optional): Number of continents
- `islands` (number, optional): Number of islands
- `terrain` (array, optional): Array of terrain type strings
- `landmarks` (array, optional): Array of landmark descriptions
- `landmasses` (array, optional): Organized landmass structure (new feature)
  - Each landmass object has:
    - `type` (string): "Continent" or "Archipelago"
    - `letter` (string): Letter designation (A, B, C, etc.)
    - `name` (string): Display name (e.g., "Continent A")
    - `territories` (array): Array of territory objects with:
      - `baseTerrain` (string): Primary terrain type
      - `traits` (array): Array of territory trait strings
      - `landmarks` (array): Array of landmark strings for this territory
      - `uniqueCompoundOrganics` (array): Array of organic compound types associated with this territory's "Unique Compound" trait (empty array if no unique compound trait)
- `mineralResources` (array, optional): Array of `{type, abundance}` objects
- `organicCompounds` (array, optional): Array of `{type, abundance}` objects
- `archeotechCaches` (array, optional): Array of `{type, abundance}` objects
- `xenosRuins` (array, optional): Array of `{type, abundance}` objects
- `inhabitants` (string, optional): Species name (only if not "None")
- `inhabitantDevelopment` (string, optional): Development level of inhabitants
- `techLevel` (string, optional): Technology level
- `population` (string, optional): Population size category
- `maidenWorld` (boolean, optional): True if this is an Eldar Maiden World
- `warpStorm` (boolean, optional): True if affected by warp storms

### Gas Giant Node

**Type**: `"gas-giant"`

Represents a gas giant planet.

```json
{
  "type": "gas-giant",
  "name": "Gas Giant",
  "description": "<p>A massive gas giant...</p>",
  "children": [
    // Lesser Moons, Orbital Features
  ]
}
```

**Note**: Gas giants follow a similar structure to planets but with fewer terrestrial properties.

### Asteroid Belt Node

**Type**: `"asteroid-belt"`

Represents an asteroid belt.

```json
{
  "type": "asteroid-belt",
  "name": "Asteroid Belt",
  "description": "<p>A dense asteroid belt...</p>",
  "mineralResources": {
    "industrialMetals": {
      "abundance": 145,
      "category": "Significant"
    },
    "ornamentals": {
      "abundance": 87,
      "category": "Significant"
    },
    "radioactives": {
      "abundance": 23,
      "category": "Limited"
    },
    "exoticMaterials": {
      "abundance": 102,
      "category": "Plentiful"
    }
  },
  "inhabitants": "Human",
  "inhabitantDevelopment": "Mining Colony"
}
```

**Fields:**
- `mineralResources` (object, optional): Structured resource data
  - Each resource type has `abundance` (number) and `category` (string: "Minimal", "Limited", "Sustainable", "Significant", "Major", "Plentiful")
  - Possible resource types: `industrialMetals`, `ornamentals`, `radioactives`, `exoticMaterials`
- `inhabitants` (string, optional): Species name (only if inhabited)
- `inhabitantDevelopment` (string, optional): Development level

### Asteroid Cluster Node

**Type**: `"asteroid-cluster"`

Similar to Asteroid Belt but represents a cluster rather than a belt.

```json
{
  "type": "asteroid-cluster",
  "name": "Asteroid Cluster",
  "description": "<p>A cluster of asteroids...</p>",
  "mineralResources": {
    "industrialMetals": {
      "abundance": 75,
      "category": "Sustainable"
    },
    "ornamentals": {
      "abundance": 25,
      "category": "Limited"
    }
  },
  "inhabitants": "Human",
  "inhabitantDevelopment": "Mining Colony"
}
```

**Fields:**
- `mineralResources` (object, optional): Structured resource data
  - Each resource type has `abundance` (number) and `category` (string: "Minimal", "Limited", "Sustainable", "Significant", "Major", "Plentiful")
  - Possible resource types: `industrialMetals`, `ornamentals`, `radioactives`, `exoticMaterials`
- `inhabitants` (string, optional): Species name (only if inhabited)
- `inhabitantDevelopment` (string, optional): Development level

### Solar Flares Node

**Type**: `"solar-flares"`

Represents solar flare hazards in a zone.

```json
{
  "type": "solar-flares",
  "name": "Solar Flares",
  "description": "<p>Solar flares in this zone...</p>",
  "numSolarFlaresInThisZone": 2
}
```

**Fields:**
- `numSolarFlaresInThisZone` (number, optional): Count of solar flare instances (affects severity)

### Radiation Bursts Node

**Type**: `"radiation-bursts"`

Represents radiation burst hazards in a zone.

```json
{
  "type": "radiation-bursts",
  "name": "Radiation Bursts",
  "description": "<p>Radiation bursts in this zone...</p>",
  "numRadiationBurstsInThisZone": 1
}
```

**Fields:**
- `numRadiationBurstsInThisZone` (number, optional): Count of radiation burst instances

### Starship Node

**Type**: `"ship"`

Represents a starship.

```json
{
  "type": "ship",
  "name": "Human Raider",
  "description": "<p>A human raider vessel...</p>",
  "species": "Human",
  "shipClass": "Raider",
  "essentialComponents": [
    "Jovian Pattern Class 2 Drive",
    "Strelov 1 Warp Engine"
  ],
  "supplementalComponents": [
    "Pressed-crew Quarters"
  ],
  "weaponComponents": [
    {
      "slot": "Prow",
      "weapon": "Mars Pattern Macrocannon"
    }
  ],
  "power": {
    "used": 45,
    "total": 50
  },
  "space": {
    "used": 38,
    "total": 40
  }
}
```

**Fields:**
- `species` (string, optional): Ship's faction/species
- `shipClass` (string, optional): Ship class name
- `essentialComponents` (array, optional): Essential component names (Human ships)
- `supplementalComponents` (array, optional): Supplemental component names (Human ships)
- `weaponComponents` (array, optional): Weapon components with `slot` and `weapon` (Human ships)
- `power` (object, optional): Power usage with `used` and `total` (Human ships)
- `space` (object, optional): Space usage with `used` and `total` (Human ships)
- `orkUpgrades` (array, optional): Ork ship upgrades (Ork ships)

### Xenos Node

**Type**: `"xenos"`

Represents an alien creature or species.

```json
{
  "type": "xenos",
  "name": "Carnivorous Reptile",
  "description": "<p>A dangerous predator...</p>",
  "stats": {
    "weaponSkill": 45,
    "ballisticSkill": 20,
    "strength": 50,
    "toughness": 45,
    "agility": 40,
    "intelligence": 15,
    "perception": 38,
    "willpower": 30,
    "fellowship": 10
  },
  "wounds": 15,
  "movement": "6/12/18/36",
  "skills": [
    "Awareness",
    "Tracking +10"
  ],
  "talents": [
    "Heightened Senses (Smell)"
  ],
  "traits": [
    "Natural Weapons (Claws, Teeth)",
    "Quadruped"
  ],
  "weapons": [
    "Claws and Bite (1d10+5 R; Pen 2)"
  ],
  "armour": "Thick Hide (2 All)"
}
```

**Fields:**
- `stats` (object, optional): Characteristic values
- `wounds` (number, optional): Wound total
- `movement` (string, optional): Movement rates
- `skills` (array, optional): Skill names with modifiers
- `talents` (array, optional): Talent names
- `traits` (array, optional): Trait descriptions
- `weapons` (array, optional): Weapon descriptions
- `armour` (string, optional): Armour description

### Notable Species Node

**Type**: `"notable-species"`

Represents a container for notable species that are tied to specific territories on a planet. This is a separate node from the regular Native Species node.

```json
{
  "type": "notable-species",
  "name": "Notable Species",
  "description": "",
  "children": [
    // Xenos nodes (species tied to territories)
  ]
}
```

**Note**: Notable Species nodes are organizational containers similar to Native Species nodes. The notable species are generated from territory traits and are displayed separately to distinguish them from regular native species. This node typically contains Xenos child nodes.

### Treasure Node

**Type**: `"treasure"`

Represents a treasure item (archeotech, xenos artifact, etc.).

```json
{
  "type": "treasure",
  "name": "Ancient Weapon",
  "description": "<p>An ancient weapon of unknown origin...</p>",
  "origin": "ArcheotechDevice",
  "treasureType": "MeleeWeapon",
  "treasureName": "Omnissian Axe",
  "craftsmanship": "Good",
  "miraclesOfTheDarkAge": [
    "Razor Sharp",
    "Sanctified"
  ],
  "quirk1": "Whispers secrets",
  "quirk2": "Glows faintly"
}
```

**Fields:**
- `origin` (string, optional): Origin type
- `treasureType` (string, optional): Treasure category
- `treasureName` (string, optional): Specific treasure name
- `craftsmanship` (string, optional): Quality level
- `miraclesOfTheDarkAge` (array, optional): Special properties (archeotech)
- `xenosConstruction` (string, optional): Xenos property
- `markOfTheCurse` (string, optional): Curse property
- `quirk1` (string, optional): First quirk
- `quirk2` (string, optional): Second quirk

### Other Node Types

Additional node types that may appear:

- `"derelict-station"`: Derelict space station
- `"dust-cloud"`: Dust cloud hazard
- `"gravity-riptide"`: Gravity riptide hazard
- `"starship-graveyard"`: Starship graveyard
- `"orbital-features"`: Container for orbital features
- `"lesser-moon"`: Small moon
- `"asteroid"`: Single large asteroid
- `"primitive-xenos"`: Container for primitive xenos
- `"native-species"`: Native species container
- `"pirate-ships"`: Pirate den

**Note**: These nodes follow similar patterns with type-specific fields. Check the `description` field for details when specific fields are not documented.

## Field Presence Rules

### Optional vs Required Fields

- **Always Present**: `type`, `name`, `description`
- **Conditionally Present**: Most other fields only appear when they have meaningful values
- **User Content**: 
  - `customNotes` only appears if the user added custom notes to the node (contains HTML formatting)
  - `customNotesPlainText` only appears if the user added custom notes to the node (plain text without HTML)
- **Children**: `children` array only appears if the node has child nodes

### When Fields Are Omitted

Fields are omitted (not set to null or empty string) when:
- The value is zero, false, or an empty array/object
- The value equals a default that has no meaning (e.g., `inhabitants: "None"`)
- The field doesn't apply to this particular node instance

This keeps the JSON clean and reduces file size.

## Best Practices for Parsing

### 1. Check for Field Existence

Always check if optional fields exist before accessing them:

```javascript
// Good
if (node.mineralResources) {
  node.mineralResources.forEach(resource => {
    // Process resource
  });
}

// Bad - will throw if field doesn't exist
node.mineralResources.forEach(resource => {
  // Process resource
});
```

### 2. Parse HTML Descriptions Carefully

The `description` field contains HTML. If you need to display it:
- Use an HTML sanitizer if displaying in a web context
- Strip tags if you need plain text
- Or better yet, use the structured data fields instead

### 3. Understand the Hierarchy

Typical hierarchy:
```
System
  └─ Zone (Inner Cauldron / Primary Biosphere / Outer Reaches)
      ├─ Planet
      │   ├─ Orbital Features
      │   └─ Lesser Moon
      ├─ Gas Giant
      │   └─ Lesser Moon
      ├─ Asteroid Belt
      ├─ Solar Flares
      └─ Radiation Bursts
```

### 4. Version Compatibility

The export format includes an `exportDate` but no version number. The structure is designed to be extensible:
- New fields may be added in future versions
- Existing fields will not be removed or renamed
- Your parser should ignore unknown fields gracefully

## Example: Complete System Export

```json
{
  "exportDate": "2025-11-05T09:00:00.000Z",
  "nodes": [
    {
      "type": "system",
      "name": "Koronus Expanse",
      "description": "<p>A remote star system...</p>",
      "star": "Red Giant",
      "starColor": "Deep red",
      "systemFeatures": ["Bountiful"],
      "children": [
        {
          "type": "zone",
          "name": "Primary Biosphere",
          "description": "<p>The habitable zone...</p>",
          "children": [
            {
              "type": "planet",
              "name": "Verdant World",
              "description": "<p>A lush planet...</p>",
              "body": "Large",
              "gravity": "Normal",
              "atmosphere": "Moderate",
              "climate": "Temperate",
              "habitability": "Verdant",
              "mineralResources": [
                { "type": "Industrial Metals", "abundance": 45 }
              ],
              "inhabitants": "Human",
              "techLevel": "Imperial (4)"
            }
          ]
        }
      ]
    }
  ]
}
```

## FAQ

**Q: Why are some fields missing from my export?**
A: Fields are only included when they have meaningful non-default values. Check the "Field Presence Rules" section.

**Q: Can I rely on the field order?**
A: Yes, `children` will always appear last. Other fields appear in a consistent order but you shouldn't rely on it for parsing.

**Q: How do I interpret the `description` HTML?**
A: The `description` is for display purposes. Use the structured data fields instead of parsing HTML.

**Q: What's the difference between `customNotes` and `customNotesPlainText`?**
A: `customNotes` contains user-added notes with HTML formatting tags (headings, bold, italic, underline, lists). `customNotesPlainText` contains the same content but with all HTML tags stripped, making it suitable for applications that don't support HTML rendering. Both fields only appear when the user has added custom notes.

**Q: Which HTML tags are allowed in `customNotes`?**
A: The following tags are supported: `h3` (heading), `b`/`strong` (bold), `i`/`em` (italic), `u` (underline), `ul` (unordered list), `ol` (ordered list), `li` (list item), `p` (paragraph), `div` (division), and `br` (line break). All other HTML tags are stripped for security.

**Q: Are there breaking changes between versions?**
A: No. The format is designed to be backward compatible. New fields may be added but existing fields won't be removed or changed.

## Support

For questions or issues with the Export JSON format:
1. Check this documentation first
2. Review the examples above
3. Examine the `description` field for additional context
4. Open an issue on the GitHub repository with sample JSON

## Version History

### Current Version (November 2025)
- **System Nodes**: Added `starColor` field (descriptive color of the star)
- **System Nodes**: Added `warpStatus` field (Warp condition: Normal, Turbulent, Becalmed, Fully becalmed)
- **System Nodes**: Added Warp Turbulence effects to `featureEffects` object:
  - `warpTurbulenceNavigationPenalty`
  - `warpTurbulencePsychicPhenomenaBonus`
  - `warpTurbulenceCorruptionIncrease`
  - `warpTurbulencePsyRatingBonus`
- **Planet Nodes**: Added `landmasses` array field for organized landmass structure
  - Continents and archipelagos with letter designations
  - Territories grouped by landmass with terrain, traits, and landmarks
- **Planet Nodes**: Added `uniqueCompoundOrganics` array field to territory objects in landmasses
  - Shows all organic compounds associated with territories that have "Unique Compound" trait
  - Supports multiple unique compounds per territory (e.g., "2x Unique Compound")
  - Allows linking terrain features to specific resources
- **New Node Type**: `notable-species` - Container for species tied to territories
- Complete data export for all node types
- System nodes include `systemCreationRules` and `featureEffects`
- Asteroid Belts include detailed resource data
- Solar Flares and Radiation Bursts include occurrence counts
- Children consistently positioned last in JSON objects
- Human-readable field names: `name`, `customNotes`, `customNotesPlainText`
- Clean data-only format without rendering metadata
- Rich text formatting support in custom notes with HTML tags
- Plain text fallback for custom notes via `customNotesPlainText` field
