# Export JSON Format Documentation

## Overview

This document describes the JSON format produced by the **Export → JSON** functionality in Rogue Trader Generator Tools. This format is designed for developers who want to integrate generated game content into their own applications or tools.

## General Structure

### Top-Level Object

When exporting from **Export → JSON → Current node** or **Export → JSON → Workspace**:

```json
{
  "exportDate": "2025-11-05T09:00:00.000Z",
  "nodes": [
    // Array of node objects
  ]
}
```

**Fields:**
- `exportDate` (string): ISO 8601 timestamp of when the export was generated
- `nodes` (array): Array of root-level node objects (systems, ships, etc.)

### Common Node Properties

All nodes share these base properties:

```json
{
  "type": "system",
  "name": "Winterscale's Realm",
  "description": "<p>HTML description of the node</p>",
  "customNotes": "Optional user notes",
  "children": []
}
```

**Fields:**
- `type` (string, required): Node type identifier (see Node Types section)
- `name` (string, required): Display name of the node
- `description` (string, required): HTML-formatted description generated by the tool
- `customNotes` (string, optional): User-added notes (only present if user added custom notes)
- `children` (array, optional): Child nodes (only present if the node has children; always appears last)

**Note on `description`**: This field contains HTML markup with the formatted display text. While you can parse this, the Export JSON includes structured data fields so you can generate your own display without parsing HTML.

## Node Types

### System Node

**Type**: `"system"`

Represents a complete star system with zones and orbital bodies.

```json
{
  "type": "system",
  "name": "Koronus Expanse System Alpha",
  "description": "<p>A system in the Koronus Expanse...</p>",
  "star": "Red Giant",
  "systemFeatures": ["Bountiful", "Haven"],
  "systemCreationRules": {
    "innerCauldronWeak": false,
    "innerCauldronDominant": false,
    "primaryBiosphereWeak": false,
    "primaryBiosphereDominant": false,
    "outerReachesWeak": false,
    "outerReachesDominant": false,
    "numExtraAsteroidBelts": 0,
    "numExtraAsteroidClusters": 0,
    "numExtraMineralResourcesPerPlanet": 2,
    "chanceForExtraExoticMaterialsPerPlanet": true,
    "bountifulAsteroids": true,
    "numExtraGravityRiptides": 0,
    "numExtraPlanetsInEachSolarZone": 1,
    "havenThickerAtmospheresInPrimaryBiosphere": true,
    "havenBetterHabitability": true,
    "ruinedEmpireExtraXenosRuinsOnDifferentPlanets": 0,
    "ruinedEmpireIncreasedAbundanceXenosRuins": false,
    "ruinedEmpireExtraArcheotechCachesOnDifferentPlanets": 0,
    "ruinedEmpireIncreasedAbundanceArcheotechCaches": false,
    "dominantRuinedSpecies": "Undefined",
    "starfarersNumSystemFeaturesInhabited": 0,
    "minimumNumPlanetsAfterModifiers": 0,
    "numPlanetsModifier": 1,
    "numPlanetsInWarpStorms": 0
  },
  "featureEffects": {
    "gravityTidesGravityWellsAroundPlanets": true,
    "illOmenedFickleFatePoints": true,
    "warpStasisNoPush": true,
    "numPlanetsInWarpStorms": 2
  },
  "children": [
    // Zone nodes, see Zone Node section
  ]
}
```

**Fields:**
- `star` (string, optional): Star type (e.g., "Red Giant", "Blue Star")
- `systemFeatures` (array, optional): Array of system feature names that were rolled
- `systemCreationRules` (object, optional): Detailed rule modifiers that affect system generation
- `featureEffects` (object, optional): Active system-wide effects from features
  - Gravity Tides effects: `gravityTidesGravityWellsAroundPlanets`, `gravityTidesTravelTimeBetweenPlanetsHalves`
  - Ill-Omened effects: `illOmenedFickleFatePoints`, `illOmenedWillPowerPenalty`, `illOmenedDoubledInsanity`, `illOmenedFearFromPsychicExploration`
  - Warp Stasis effects: `warpStasisFocusPowerPenalties`, `warpStasisNoPush`, `warpStasisReducedPsychicPhenomena`
  - Warp Turbulence: `numPlanetsInWarpStorms` (number)

### Zone Node

**Type**: `"zone"`

Represents a solar zone within a system (Inner Cauldron, Primary Biosphere, Outer Reaches).

```json
{
  "type": "zone",
  "name": "Primary Biosphere",
  "description": "<p>The habitable zone...</p>",
  "children": [
    // Planet, Asteroid Belt, Gas Giant, etc.
  ]
}
```

**Note**: Zone nodes primarily serve as organizational containers. Their children contain the actual orbital features.

### Planet Node

**Type**: `"planet"`

Represents a planet or large moon.

```json
{
  "type": "planet",
  "name": "Verdant World",
  "description": "<p>A lush, habitable planet...</p>",
  "isMoon": false,
  "body": "Large",
  "gravity": "Normal",
  "atmosphere": "Moderate",
  "atmosphericComposition": "Tainted",
  "climate": "Temperate",
  "habitability": "Verdant",
  "continents": 3,
  "islands": 5,
  "terrain": [
    "Forest",
    "Mountains",
    "Ocean"
  ],
  "landmarks": [
    "Ancient ruins",
    "Volcanic caldera"
  ],
  "mineralResources": [
    { "type": "Industrial Metals", "abundance": 45 },
    { "type": "Ornamentals", "abundance": 30 }
  ],
  "organicCompounds": [
    { "type": "Prey Animals", "abundance": 60 }
  ],
  "archeotechCaches": [
    { "type": "Archeotech Cache", "abundance": 15 }
  ],
  "xenosRuins": [
    { "type": "Xenos Ruins", "abundance": 25 }
  ],
  "inhabitants": "Human",
  "inhabitantDevelopment": "Colony",
  "techLevel": "Imperial (4)",
  "population": "Hundreds of Millions",
  "maidenWorld": false,
  "warpStorm": false,
  "children": [
    // Orbital Features, Lesser Moons, etc.
  ]
}
```

**Fields:**
- `isMoon` (boolean, optional): True if this is a moon rather than a planet
- `body` (string, optional): Size category
- `gravity` (string, optional): Gravity description
- `atmosphere` (string, optional): Atmospheric presence
- `atmosphericComposition` (string, optional): Atmospheric composition type
- `climate` (string, optional): Climate description
- `habitability` (string, optional): Habitability level (only if not "Inhospitable")
- `continents` (number, optional): Number of continents
- `islands` (number, optional): Number of islands
- `terrain` (array, optional): Array of terrain type strings
- `landmarks` (array, optional): Array of landmark descriptions
- `mineralResources` (array, optional): Array of `{type, abundance}` objects
- `organicCompounds` (array, optional): Array of `{type, abundance}` objects
- `archeotechCaches` (array, optional): Array of `{type, abundance}` objects
- `xenosRuins` (array, optional): Array of `{type, abundance}` objects
- `inhabitants` (string, optional): Species name (only if not "None")
- `inhabitantDevelopment` (string, optional): Development level of inhabitants
- `techLevel` (string, optional): Technology level
- `population` (string, optional): Population size category
- `maidenWorld` (boolean, optional): True if this is an Eldar Maiden World
- `warpStorm` (boolean, optional): True if affected by warp storms

### Gas Giant Node

**Type**: `"gas-giant"`

Represents a gas giant planet.

```json
{
  "type": "gas-giant",
  "name": "Gas Giant",
  "description": "<p>A massive gas giant...</p>",
  "children": [
    // Lesser Moons, Orbital Features
  ]
}
```

**Note**: Gas giants follow a similar structure to planets but with fewer terrestrial properties.

### Asteroid Belt Node

**Type**: `"asteroid-belt"`

Represents an asteroid belt.

```json
{
  "type": "asteroid-belt",
  "name": "Asteroid Belt",
  "description": "<p>A dense asteroid belt...</p>",
  "mineralResources": {
    "industrialMetals": {
      "abundance": 145,
      "category": "Significant"
    },
    "ornamentals": {
      "abundance": 87,
      "category": "Significant"
    },
    "radioactives": {
      "abundance": 23,
      "category": "Limited"
    },
    "exoticMaterials": {
      "abundance": 102,
      "category": "Plentiful"
    }
  },
  "inhabitants": "Human",
  "inhabitantDevelopment": "Mining Colony"
}
```

**Fields:**
- `mineralResources` (object, optional): Structured resource data
  - Each resource type has `abundance` (number) and `category` (string: "Minimal", "Limited", "Sustainable", "Significant", "Major", "Plentiful")
  - Possible resource types: `industrialMetals`, `ornamentals`, `radioactives`, `exoticMaterials`
- `inhabitants` (string, optional): Species name (only if inhabited)
- `inhabitantDevelopment` (string, optional): Development level

### Asteroid Cluster Node

**Type**: `"asteroid-cluster"`

Similar to Asteroid Belt but represents a cluster rather than a belt.

```json
{
  "type": "asteroid-cluster",
  "name": "Asteroid Cluster",
  "description": "<p>A cluster of asteroids...</p>",
  "mineralResources": [
    "Significant (75) industrial metals",
    "Limited (25) ornamentals"
  ],
  "inhabitants": "None"
}
```

**Fields:**
- `mineralResources` (array, optional): Array of human-readable resource strings
- `inhabitants` (string, optional): Species name
- `inhabitantDevelopment` (string, optional): Development level

### Solar Flares Node

**Type**: `"solar-flares"`

Represents solar flare hazards in a zone.

```json
{
  "type": "solar-flares",
  "name": "Solar Flares",
  "description": "<p>Solar flares in this zone...</p>",
  "numSolarFlaresInThisZone": 2
}
```

**Fields:**
- `numSolarFlaresInThisZone` (number, optional): Count of solar flare instances (affects severity)

### Radiation Bursts Node

**Type**: `"radiation-bursts"`

Represents radiation burst hazards in a zone.

```json
{
  "type": "radiation-bursts",
  "name": "Radiation Bursts",
  "description": "<p>Radiation bursts in this zone...</p>",
  "numRadiationBurstsInThisZone": 1
}
```

**Fields:**
- `numRadiationBurstsInThisZone` (number, optional): Count of radiation burst instances

### Starship Node

**Type**: `"ship"`

Represents a starship.

```json
{
  "type": "ship",
  "name": "Human Raider",
  "description": "<p>A human raider vessel...</p>",
  "species": "Human",
  "shipClass": "Raider",
  "essentialComponents": [
    "Jovian Pattern Class 2 Drive",
    "Strelov 1 Warp Engine"
  ],
  "supplementalComponents": [
    "Pressed-crew Quarters"
  ],
  "weaponComponents": [
    {
      "slot": "Prow",
      "weapon": "Mars Pattern Macrocannon"
    }
  ],
  "power": {
    "used": 45,
    "total": 50
  },
  "space": {
    "used": 38,
    "total": 40
  }
}
```

**Fields:**
- `species` (string, optional): Ship's faction/species
- `shipClass` (string, optional): Ship class name
- `essentialComponents` (array, optional): Essential component names (Human ships)
- `supplementalComponents` (array, optional): Supplemental component names (Human ships)
- `weaponComponents` (array, optional): Weapon components with `slot` and `weapon` (Human ships)
- `power` (object, optional): Power usage with `used` and `total` (Human ships)
- `space` (object, optional): Space usage with `used` and `total` (Human ships)
- `orkUpgrades` (array, optional): Ork ship upgrades (Ork ships)

### Xenos Node

**Type**: `"xenos"`

Represents an alien creature or species.

```json
{
  "type": "xenos",
  "name": "Carnivorous Reptile",
  "description": "<p>A dangerous predator...</p>",
  "stats": {
    "weaponSkill": 45,
    "ballisticSkill": 20,
    "strength": 50,
    "toughness": 45,
    "agility": 40,
    "intelligence": 15,
    "perception": 38,
    "willpower": 30,
    "fellowship": 10
  },
  "wounds": 15,
  "movement": "6/12/18/36",
  "skills": [
    "Awareness",
    "Tracking +10"
  ],
  "talents": [
    "Heightened Senses (Smell)"
  ],
  "traits": [
    "Natural Weapons (Claws, Teeth)",
    "Quadruped"
  ],
  "weapons": [
    "Claws and Bite (1d10+5 R; Pen 2)"
  ],
  "armour": "Thick Hide (2 All)"
}
```

**Fields:**
- `stats` (object, optional): Characteristic values
- `wounds` (number, optional): Wound total
- `movement` (string, optional): Movement rates
- `skills` (array, optional): Skill names with modifiers
- `talents` (array, optional): Talent names
- `traits` (array, optional): Trait descriptions
- `weapons` (array, optional): Weapon descriptions
- `armour` (string, optional): Armour description

### Treasure Node

**Type**: `"treasure"`

Represents a treasure item (archeotech, xenos artifact, etc.).

```json
{
  "type": "treasure",
  "name": "Ancient Weapon",
  "description": "<p>An ancient weapon of unknown origin...</p>",
  "origin": "ArcheotechDevice",
  "treasureType": "MeleeWeapon",
  "treasureName": "Omnissian Axe",
  "craftsmanship": "Good",
  "miraclesOfTheDarkAge": [
    "Razor Sharp",
    "Sanctified"
  ],
  "quirk1": "Whispers secrets",
  "quirk2": "Glows faintly"
}
```

**Fields:**
- `origin` (string, optional): Origin type
- `treasureType` (string, optional): Treasure category
- `treasureName` (string, optional): Specific treasure name
- `craftsmanship` (string, optional): Quality level
- `miraclesOfTheDarkAge` (array, optional): Special properties (archeotech)
- `xenosConstruction` (string, optional): Xenos property
- `markOfTheCurse` (string, optional): Curse property
- `quirk1` (string, optional): First quirk
- `quirk2` (string, optional): Second quirk

### Other Node Types

Additional node types that may appear:

- `"derelict-station"`: Derelict space station
- `"dust-cloud"`: Dust cloud hazard
- `"gravity-riptide"`: Gravity riptide hazard
- `"starship-graveyard"`: Starship graveyard
- `"orbital-features"`: Container for orbital features
- `"lesser-moon"`: Small moon
- `"asteroid"`: Single large asteroid
- `"primitive-xenos"`: Container for primitive xenos
- `"native-species"`: Native species container
- `"pirate-ships"`: Pirate den

**Note**: These nodes follow similar patterns with type-specific fields. Check the `description` field for details when specific fields are not documented.

## Field Presence Rules

### Optional vs Required Fields

- **Always Present**: `type`, `name`, `description`
- **Conditionally Present**: Most other fields only appear when they have meaningful values
- **User Content**: `customNotes` only appears if the user added custom notes to the node
- **Children**: `children` array only appears if the node has child nodes

### When Fields Are Omitted

Fields are omitted (not set to null or empty string) when:
- The value is zero, false, or an empty array/object
- The value equals a default that has no meaning (e.g., `inhabitants: "None"`)
- The field doesn't apply to this particular node instance

This keeps the JSON clean and reduces file size.

## Best Practices for Parsing

### 1. Check for Field Existence

Always check if optional fields exist before accessing them:

```javascript
// Good
if (node.mineralResources) {
  node.mineralResources.forEach(resource => {
    // Process resource
  });
}

// Bad - will throw if field doesn't exist
node.mineralResources.forEach(resource => {
  // Process resource
});
```

### 2. Handle Different Resource Formats

Note that `AsteroidBeltNode` and `AsteroidClusterNode` use different resource formats:
- Asteroid Belts: Structured object with named properties
- Asteroid Clusters: Array of formatted strings

### 3. Parse HTML Descriptions Carefully

The `description` field contains HTML. If you need to display it:
- Use an HTML sanitizer if displaying in a web context
- Strip tags if you need plain text
- Or better yet, use the structured data fields instead

### 4. Understand the Hierarchy

Typical hierarchy:
```
System
  └─ Zone (Inner Cauldron / Primary Biosphere / Outer Reaches)
      ├─ Planet
      │   ├─ Orbital Features
      │   └─ Lesser Moon
      ├─ Gas Giant
      │   └─ Lesser Moon
      ├─ Asteroid Belt
      ├─ Solar Flares
      └─ Radiation Bursts
```

### 5. Version Compatibility

The export format includes an `exportDate` but no version number. The structure is designed to be extensible:
- New fields may be added in future versions
- Existing fields will not be removed or renamed
- Your parser should ignore unknown fields gracefully

## Example: Complete System Export

```json
{
  "exportDate": "2025-11-05T09:00:00.000Z",
  "nodes": [
    {
      "type": "system",
      "name": "Koronus Expanse",
      "description": "<p>A remote star system...</p>",
      "star": "Red Giant",
      "systemFeatures": ["Bountiful"],
      "children": [
        {
          "type": "zone",
          "name": "Primary Biosphere",
          "description": "<p>The habitable zone...</p>",
          "children": [
            {
              "type": "planet",
              "name": "Verdant World",
              "description": "<p>A lush planet...</p>",
              "body": "Large",
              "gravity": "Normal",
              "atmosphere": "Moderate",
              "climate": "Temperate",
              "habitability": "Verdant",
              "mineralResources": [
                { "type": "Industrial Metals", "abundance": 45 }
              ],
              "inhabitants": "Human",
              "techLevel": "Imperial (4)"
            }
          ]
        }
      ]
    }
  ]
}
```

## FAQ

**Q: Why are some fields missing from my export?**
A: Fields are only included when they have meaningful non-default values. Check the "Field Presence Rules" section.

**Q: Can I rely on the field order?**
A: Yes, `children` will always appear last. Other fields appear in a consistent order but you shouldn't rely on it for parsing.

**Q: How do I interpret the `description` HTML?**
A: The `description` is for display purposes. Use the structured data fields instead of parsing HTML.

**Q: Are there breaking changes between versions?**
A: No. The format is designed to be backward compatible. New fields may be added but existing fields won't be removed or changed.

**Q: Why do resource formats differ between node types?**
A: Asteroid Belts use structured objects (more precise), while Asteroid Clusters use formatted strings (simpler, matches game presentation).

## Support

For questions or issues with the Export JSON format:
1. Check this documentation first
2. Review the examples above
3. Examine the `description` field for additional context
4. Open an issue on the GitHub repository with sample JSON

## Version History

### Current Version
- Complete data export for all node types
- System nodes include `systemCreationRules` and `featureEffects`
- Asteroid Belts include detailed resource data
- Solar Flares and Radiation Bursts include occurrence counts
- Children consistently positioned last in JSON objects
- Human-readable field names: `name`, `customNotes`
- Clean data-only format without rendering metadata
